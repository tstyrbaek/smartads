<IfModule mod_rewrite.c>
  RewriteEngine On

  Options +FollowSymLinks

  # Block direct access to internal folders
  RewriteRule ^backend/(?!public/).* - [F,L]

  # âœ… Serve /storage files directly if they exist (do NOT route to Laravel)
  RewriteCond %{REQUEST_URI} ^/storage/ [NC]
  RewriteCond %{DOCUMENT_ROOT}/backend/public%{REQUEST_URI} -f [OR]
  RewriteCond %{DOCUMENT_ROOT}/backend/public%{REQUEST_URI} -d
  RewriteRule ^ backend/public%{REQUEST_URI} [L]

  # Route backend requests (Laravel)
  RewriteCond %{REQUEST_URI} ^/(admin|api|sanctum|storage)(/|$) [NC]
  RewriteRule ^ backend/public/index.php [L,QSA]

  # Serve built frontend assets if they exist in backend/public
  RewriteCond %{DOCUMENT_ROOT}/backend/public%{REQUEST_URI} -f
  RewriteRule ^ backend/public%{REQUEST_URI} [L]

  RewriteCond %{DOCUMENT_ROOT}/backend/public%{REQUEST_URI} -d
  RewriteRule ^ backend/public%{REQUEST_URI} [L]

  # Frontend SPA fallback
  RewriteRule ^ backend/public/index.html [L]
</IfModule>